%==============================================================================
%  3D Wing in a Box – Incompressible RANS (SST)
%==============================================================================

% --------------------- GOVERNING EQUATIONS -----------------------------------
SOLVER= INC_RANS
KIND_TURB_MODEL= SST
SST_OPTIONS= V2003m
KIND_TRANS_MODEL= NONE
MATH_PROBLEM= DIRECT
RESTART_SOL= NO

% --------------------- STEADY / UNSTEADY -------------------------------------
TIME_DOMAIN= NO
TIME_MARCHING= NO

% --------------------- FLUID & FLOW DEFINITION -------------------------------
INC_NONDIM= DIMENSIONAL

INC_DENSITY_MODEL= CONSTANT
INC_DENSITY_INIT= 1.225        % kg/m^3 (air)

VISCOSITY_MODEL= CONSTANT_VISCOSITY
MU_CONSTANT= 1.789e-5          % Pa·s

INC_ENERGY_EQUATION= NO

% Turbulence freestream (roughly 1% intensity, μ_t / μ_l ≈ 10)
FREESTREAM_TURBULENCEINTENSITY= 0.01
FREESTREAM_TURB2LAMVISCRATIO  = 10.0

% --------------------- REFERENCE VALUES (FOR CL/CD) --------------------------
% Set these to your geometry:
REF_DENSITY = 1.225            % same as INC_DENSITY_INIT
REF_VELOCITY= 50.0             % freestream speed (below)
REF_LENGTH  = 1.0              % e.g. mean aerodynamic chord [m]
REF_AREA    = 1.0              % e.g. wing planform area [m^2]

REF_ORIGIN_MOMENT_X = 0.25     % e.g. 1/4 chord
REF_ORIGIN_MOMENT_Y = 0.0
REF_ORIGIN_MOMENT_Z = 0.0

% --------------------- INITIAL CONDITIONS ------------------------------------
INC_VELOCITY_INIT   = ( 50.0, 0.0, 0.0 )
INC_TEMPERATURE_INIT= 288.15
INC_PRESSURE_INIT   = 0.0

% --------------------- MESH ---------------------------------------------------
MESH_FORMAT   = SU2
MESH_FILENAME = ../mesh/mesh.su2
MESH_OUT_FILENAME = mesh_out.su2

% --------------------- BOUNDARY CONDITIONS -----------------------------------
%  Flow direction: +x, 8° AoA in x–z plane
%  U = 50 m/s * (cos 8°, 0, sin 8°)
%  cos 8° ≈ 0.99026807,   sin 8° ≈ 0.13917310

INC_INLET_TYPE  = VELOCITY_INLET
INC_OUTLET_TYPE = PRESSURE_OUTLET

MARKER_INLET  = ( inlet, 288.15, 50.0, 0.99026807, 0.0, 0.13917310 )
MARKER_OUTLET = ( outlet, 0.0 )

% Adiabatic no-slip wall
MARKER_HEATFLUX = ( walls, 0.0 )

% Farfield box
MARKER_FAR = ( farfield )

% Surfaces to write in surface solution & to use for forces
MARKER_PLOTTING   = ( inlet, outlet, walls, farfield )
MARKER_MONITORING = ( walls )

% --------------------- NUMERICAL METHOD – FLOW -------------------------------
NUM_METHOD_GRAD       = GREEN_GAUSS
CONV_NUM_METHOD_FLOW  = FDS         % upwind scheme for INC_RANS
MUSCL_FLOW            = YES
SLOPE_LIMITER_FLOW    = VENKATAKRISHNAN

TIME_DISCRE_FLOW      = EULER_IMPLICIT

CFL_NUMBER   = 5.0
CFL_ADAPT    = YES
CFL_ADAPT_PARAM = ( 1.5, 0.5, 1.0, 100.0 )

% Linear solver
LINEAR_SOLVER       = FGMRES
LINEAR_SOLVER_PREC  = ILU
LINEAR_SOLVER_ERROR = 1E-6
LINEAR_SOLVER_ITER  = 200

% --------------------- NUMERICAL METHOD – TURBULENCE -------------------------
CONV_NUM_METHOD_TURB = SCALAR_UPWIND
SPATIAL_ORDER_TURB   = 1ST_ORDER
TIME_DISCRE_TURB     = EULER_IMPLICIT

% --------------------- CONVERGENCE CONTROL -----------------------------------
ITER                    = 1000
CONV_RESIDUAL_MINVAL    = -8
CONV_STARTITER          = 10
CONV_CAUCHY_ELEMS       = 100
CONV_CAUCHY_EPS         = 1E-6
CONV_FIELD              = RMS_DENSITY

% --------------------- OUTPUT ------------------------------------------------
OUTPUT_FILES    = ( RESTART, PARAVIEW, SURFACE_PARAVIEW )
OUTPUT_WRT_FREQ = 100

% what goes into .vtu/.vtu_surface
VOLUME_OUTPUT  = COORDINATES, PRIMITIVE, SOLUTION
SURFACE_OUTPUT = COORDINATES, PRIMITIVE, SOLUTION

SCREEN_OUTPUT  = YES
HISTORY_OUTPUT = ( ITER, RMS_RES, LIFT, DRAG, LIFT_COEFF, DRAG_COEFF, MOMENT_Z )

HISTORY_WRT_FREQ_INNER = 10
